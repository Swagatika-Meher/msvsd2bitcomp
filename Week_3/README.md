# INDEX
* [Week 3](#Week-3)
  * [Xschem: Pre-layout simulation for Ring Oscillator](#Xschem-Pre-layout-simulation-for-Ring-Oscillator)
    * Netlist of pre-layout testbench schematic
    * NgSpice plot
  * [ALIGN: Post-layout simulation for Ring Oscillator](#ALIGN-Post-layout-simulation-for-Ring-Oscillator)
    * Generated .gds and .lef files in KLayout
    * Extracted Post-layout spice netlist
    * NgSpice Plot
    * Comparison between pre-layout and post-layout [ALIGN] NgSpice Plot
   
# Xschem: Pre-layout simulation for Ring Oscillator
A ring oscillator is an electronic circuit that generates a periodic waveform, typically a square wave or a sine wave, using a feedback loop of inverters or delay elements. It is a type of oscillator that does not require any external components like resistors, capacitors or crystals to generate a clock signal.

The basic principle behind the ring oscillator is that a chain of odd number of inverters are connected in a loop, and the output of the last inverter is fed back to the input of the first inverter. This creates a positive feedback loop that causes the circuit to oscillate at a frequency determined by the delay of each inverter.

Ring oscillators are widely used in digital circuits as clock generators, frequency dividers, and timing references. They are simple and easy to implement, making them popular in integrated circuits where small size and low power consumption are critical factors.

The following figure depicts a 3-stage ring oscillator in Xschem.

![Z1](https://user-images.githubusercontent.com/114692581/222699738-a392a4bc-d68e-4288-b982-a13d5ac4c54f.PNG)

3-stage ring oscillator shown as a symbol in following figure.

![Z2](https://user-images.githubusercontent.com/114692581/222699994-b1716570-6c32-4222-a64e-92b8e8e7aafc.PNG)

3-stage ring oscillator shown as a testbench schematic in following figure.

![Z3](https://user-images.githubusercontent.com/114692581/222700155-81a26743-07e0-41e8-a110-710d6dc82d21.PNG)

**Netlist of pre-layout testbench schematic :**
```
** sch_path: /home/swagatika/Desktop/Circuits/RingOscillator_tb.sch
**.subckt RingOscillator_tb out
*.opin out
x1 VDD out GND RingOscillator_sym
V1 VDD GND 1.8
.save i(v1)
**** begin user architecture code
.lib /home/swagatika/open_pdks/sky130/sky130A/libs.tech/ngspice/sky130.lib.spice tt
.save all

.tran 1p 5n
.control
run
plot out
.save all
.endc
.end

**** end user architecture code
**.ends

* expanding   symbol:  /home/swagatika/Desktop/Circuits/RingOscillator_sym.sym # of pins=3
** sym_path: /home/swagatika/Desktop/Circuits/RingOscillator_sym.sym
** sch_path: /home/swagatika/Desktop/Circuits/RingOscillator_sym.sch
.subckt RingOscillator_sym Vdd out Gnd
*.opin out
*.iopin Vdd
*.iopin Gnd
XM1 net1 out Vdd Vdd sky130_fd_pr__pfet_01v8 L=0.15 W=1 nf=1 ad='int((nf+1)/2) * W/nf * 0.29' as='int((nf+2)/2) * W/nf * 0.29'
+ pd='2*int((nf+1)/2) * (W/nf + 0.29)' ps='2*int((nf+2)/2) * (W/nf + 0.29)' nrd='0.29 / W' nrs='0.29 / W'
+ sa=0 sb=0 sd=0 mult=1 m=1
XM2 net2 net1 Vdd Vdd sky130_fd_pr__pfet_01v8 L=0.15 W=1 nf=1 ad='int((nf+1)/2) * W/nf * 0.29' as='int((nf+2)/2) * W/nf * 0.29'
+ pd='2*int((nf+1)/2) * (W/nf + 0.29)' ps='2*int((nf+2)/2) * (W/nf + 0.29)' nrd='0.29 / W' nrs='0.29 / W'
+ sa=0 sb=0 sd=0 mult=1 m=1
XM3 out net2 Vdd Vdd sky130_fd_pr__pfet_01v8 L=0.15 W=1 nf=1 ad='int((nf+1)/2) * W/nf * 0.29' as='int((nf+2)/2) * W/nf * 0.29'
+ pd='2*int((nf+1)/2) * (W/nf + 0.29)' ps='2*int((nf+2)/2) * (W/nf + 0.29)' nrd='0.29 / W' nrs='0.29 / W'
+ sa=0 sb=0 sd=0 mult=1 m=1
XM4 net1 out Gnd Gnd sky130_fd_pr__nfet_01v8 L=0.15 W=1 nf=1 ad='int((nf+1)/2) * W/nf * 0.29' as='int((nf+2)/2) * W/nf * 0.29'
+ pd='2*int((nf+1)/2) * (W/nf + 0.29)' ps='2*int((nf+2)/2) * (W/nf + 0.29)' nrd='0.29 / W' nrs='0.29 / W'
+ sa=0 sb=0 sd=0 mult=1 m=1
XM5 net2 net1 Gnd Gnd sky130_fd_pr__nfet_01v8 L=0.15 W=1 nf=1 ad='int((nf+1)/2) * W/nf * 0.29' as='int((nf+2)/2) * W/nf * 0.29'
+ pd='2*int((nf+1)/2) * (W/nf + 0.29)' ps='2*int((nf+2)/2) * (W/nf + 0.29)' nrd='0.29 / W' nrs='0.29 / W'
+ sa=0 sb=0 sd=0 mult=1 m=1
XM6 out net2 Gnd Gnd sky130_fd_pr__nfet_01v8 L=0.15 W=1 nf=1 ad='int((nf+1)/2) * W/nf * 0.29' as='int((nf+2)/2) * W/nf * 0.29'
+ pd='2*int((nf+1)/2) * (W/nf + 0.29)' ps='2*int((nf+2)/2) * (W/nf + 0.29)' nrd='0.29 / W' nrs='0.29 / W'
+ sa=0 sb=0 sd=0 mult=1 m=1
.ends

.GLOBAL GND
.GLOBAL VDD
.end
```
After successfully running for 5ns with 1ps steps, the generated NgSpice plot shown below.

![Z5](https://user-images.githubusercontent.com/114692581/222702918-e694787d-399f-407c-bb02-859e96cb7fba.PNG)

![z4](https://user-images.githubusercontent.com/114692581/222702602-7b4dbadf-99a3-45cd-84d6-5bbbc09e6f4a.PNG)

# ALIGN: Post-layout simulation for Ring Oscillator
A simple SPICE Netlist for ring oscillator is generated by modifying the pre-layout testbench netlist and saved in `.sp` format to generate `.lef` and `.gds` files.

Input netlist for ALIGN tool,
```
.subckt RingOscillator Vdd out Gnd

XM1 net1 out Vdd Vdd sky130_fd_pr__pfet_01v8 L=150n W=1050n nf=8
XM2 net2 net1 Vdd Vdd sky130_fd_pr__pfet_01v8 L=150n W=1050n nf=8
XM3 out net2 Vdd Vdd sky130_fd_pr__pfet_01v8 L=150n W=1050n nf=8
XM4 net1 out Gnd Gnd sky130_fd_pr__nfet_01v8 L=150n W=1050n nf=8
XM5 net2 net1 Gnd Gnd sky130_fd_pr__nfet_01v8 L=150n W=1050n nf=8
XM6 out net2 Gnd Gnd sky130_fd_pr__nfet_01v8 L=150n W=1050n nf=8
.ends RingOscillator
```
> **NOTE:** In input netlist of ALIGN tool, the parameter 'nf' that is, number of finger should be in even number. But, when the number of finger in input netlist of ring oscillator is setting  into 2 and 4, it is giving incorrect [result](https://github.com/Swagatika-Meher/msvsd2bitcomp/tree/main/Week_3/Number_of_Fingers). The models generated in the simulation may not accurately capture the behavior of the ring oscillator layout.

> When we are increasing the value of 'nf' that is, 6, 8, 10..., we got the accurate result same as pre-layout which is going to discuss in below sections.


Run the ALIGN tool using below commands.
```
$ python3 -m venv general
$ source general/bin/activate
```
Go to ALIGN-public directory,
```
$ cd work
$ schematic2layout.py ../ALIGN-pdk-sky130/examples/ringosci -p ../pdks/SKY130_PDK/
```
Successfully generated the `.gds`and `.lef` files.

![Z6](https://user-images.githubusercontent.com/114692581/222713798-5ace4ab6-22d8-4e94-a244-5b99b51b827c.PNG)

![Z7](https://user-images.githubusercontent.com/114692581/222713845-3e941886-d5dc-49bf-a50a-77757bb28058.PNG)


## Generated .gds and .lef files in KLayout
* **.gds**
  
  ![Z8](https://user-images.githubusercontent.com/114692581/222714535-03657c78-470c-4377-83f7-fc9228ebec5b.PNG)
  
* **.lef**
  
  ![Z9](https://user-images.githubusercontent.com/114692581/222714589-9970ec6b-ac4c-4fc8-b729-54c54dd2ebfd.PNG)
  
To extract the spice netlist of above post-layout go to MAGIC tool and read the `.gds` file. Open magic tool and `go to file --> read GDS --> open the .gds file` and view the layout in magic tool.

![Z10](https://user-images.githubusercontent.com/114692581/222716055-26aed7eb-9393-4e76-8184-15451dc86bfa.PNG)

Now, click `i` and go to `Tkcon.tcl` command window. Type the following command to extract the netlist.
```
extract do local
extract all
ext2spice cthresh 0 rthresh 0
ext2spice
```
**Align post layout .spice file is created in magic working directory,**
```
* SPICE3 file created from RINGOSCILLATOR_0.ext - technology: sky130A

X0 OUT m1_1258_1568# VDD VDD sky130_fd_pr__pfet_01v8 ad=1.176e+12p pd=1.064e+07u as=4.3155e+12p ps=3.972e+07u w=1.05e+06u l=150000u
X1 VDD m1_1258_1568# OUT VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X2 VDD m1_1258_1568# OUT VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X3 OUT m1_1258_1568# VDD VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X4 OUT m1_1258_1568# VDD VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X5 VDD m1_1258_1568# OUT VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X6 VDD m1_1258_1568# OUT VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X7 OUT m1_1258_1568# VDD VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X8 OUT m1_1258_1568# GND GND sky130_fd_pr__nfet_01v8 ad=1.176e+12p pd=1.064e+07u as=4.3155e+12p ps=3.972e+07u w=1.05e+06u l=150000u
X9 OUT m1_1258_1568# GND GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X10 GND m1_1258_1568# OUT GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X11 GND m1_1258_1568# OUT GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X12 OUT m1_1258_1568# GND GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X13 OUT m1_1258_1568# GND GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X14 GND m1_1258_1568# OUT GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X15 GND m1_1258_1568# OUT GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X16 m1_1258_1568# STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# GND GND sky130_fd_pr__nfet_01v8 ad=1.176e+12p pd=1.064e+07u as=0p ps=0u w=1.05e+06u l=150000u
X17 m1_1258_1568# STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# GND GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X18 GND STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# m1_1258_1568# GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X19 GND STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# m1_1258_1568# GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X20 m1_1258_1568# STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# GND GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X21 m1_1258_1568# STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# GND GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X22 GND STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# m1_1258_1568# GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X23 GND STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# m1_1258_1568# GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X24 STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# OUT GND GND sky130_fd_pr__nfet_01v8 ad=1.176e+12p pd=1.064e+07u as=0p ps=0u w=1.05e+06u l=150000u
X25 STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# OUT GND GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X26 GND OUT STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X27 GND OUT STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X28 STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# OUT GND GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X29 STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# OUT GND GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X30 GND OUT STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X31 GND OUT STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X32 m1_1258_1568# STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# VDD VDD sky130_fd_pr__pfet_01v8 ad=1.176e+12p pd=1.064e+07u as=0p ps=0u w=1.05e+06u l=150000u
X33 VDD STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# m1_1258_1568# VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X34 VDD STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# m1_1258_1568# VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X35 m1_1258_1568# STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# VDD VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X36 m1_1258_1568# STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# VDD VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X37 VDD STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# m1_1258_1568# VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X38 VDD STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# m1_1258_1568# VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X39 m1_1258_1568# STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# VDD VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X40 STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# OUT VDD VDD sky130_fd_pr__pfet_01v8 ad=1.176e+12p pd=1.064e+07u as=0p ps=0u w=1.05e+06u l=150000u
X41 VDD OUT STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X42 VDD OUT STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X43 STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# OUT VDD VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X44 STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# OUT VDD VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X45 VDD OUT STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X46 VDD OUT STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X47 STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# OUT VDD VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
C0 STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# OUT 1.29fF
C1 VDD m1_1258_1568# 7.25fF
C2 VDD OUT 7.03fF
C3 OUT m1_1258_1568# 1.34fF
C4 VDD STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# 6.86fF
C5 STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# m1_1258_1568# 1.02fF
C6 OUT GND 5.68fF **FLOATING
C7 m1_1258_1568# GND 5.43fF **FLOATING
C8 STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# GND 4.29fF **FLOATING
C9 VDD GND 14.43fF **FLOATING
```

After exporting '.gds' file generated by Align to magic and extract '.spice' file, manually the `.control` statements are added and the postlayout (generated by ALIGN tool) compared with pre-layout testbench ring oscillator schematic.
```
* SPICE3 file created from RINGOSCILLATOR_0.ext - technology: sky130A

.subckt RINGOSCILLATOR_0 VDD out GND
X0 OUT m1_1258_1568# VDD VDD sky130_fd_pr__pfet_01v8 ad=1.176e+12p pd=1.064e+07u as=4.3155e+12p ps=3.972e+07u w=1.05e+06u l=150000u
X1 VDD m1_1258_1568# OUT VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X2 VDD m1_1258_1568# OUT VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X3 OUT m1_1258_1568# VDD VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X4 OUT m1_1258_1568# VDD VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X5 VDD m1_1258_1568# OUT VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X6 VDD m1_1258_1568# OUT VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X7 OUT m1_1258_1568# VDD VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X8 OUT m1_1258_1568# GND GND sky130_fd_pr__nfet_01v8 ad=1.176e+12p pd=1.064e+07u as=4.3155e+12p ps=3.972e+07u w=1.05e+06u l=150000u
X9 OUT m1_1258_1568# GND GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X10 GND m1_1258_1568# OUT GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X11 GND m1_1258_1568# OUT GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X12 OUT m1_1258_1568# GND GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X13 OUT m1_1258_1568# GND GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X14 GND m1_1258_1568# OUT GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X15 GND m1_1258_1568# OUT GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X16 m1_1258_1568# STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# GND GND sky130_fd_pr__nfet_01v8 ad=1.176e+12p pd=1.064e+07u as=0p ps=0u w=1.05e+06u l=150000u
X17 m1_1258_1568# STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# GND GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X18 GND STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# m1_1258_1568# GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X19 GND STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# m1_1258_1568# GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X20 m1_1258_1568# STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# GND GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X21 m1_1258_1568# STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# GND GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X22 GND STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# m1_1258_1568# GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X23 GND STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# m1_1258_1568# GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X24 STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# OUT GND GND sky130_fd_pr__nfet_01v8 ad=1.176e+12p pd=1.064e+07u as=0p ps=0u w=1.05e+06u l=150000u
X25 STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# OUT GND GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X26 GND OUT STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X27 GND OUT STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X28 STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# OUT GND GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X29 STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# OUT GND GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X30 GND OUT STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X31 GND OUT STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# GND sky130_fd_pr__nfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X32 m1_1258_1568# STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# VDD VDD sky130_fd_pr__pfet_01v8 ad=1.176e+12p pd=1.064e+07u as=0p ps=0u w=1.05e+06u l=150000u
X33 VDD STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# m1_1258_1568# VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X34 VDD STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# m1_1258_1568# VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X35 m1_1258_1568# STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# VDD VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X36 m1_1258_1568# STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# VDD VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X37 VDD STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# m1_1258_1568# VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X38 VDD STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# m1_1258_1568# VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X39 m1_1258_1568# STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# VDD VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X40 STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# OUT VDD VDD sky130_fd_pr__pfet_01v8 ad=1.176e+12p pd=1.064e+07u as=0p ps=0u w=1.05e+06u l=150000u
X41 VDD OUT STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X42 VDD OUT STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X43 STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# OUT VDD VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X44 STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# OUT VDD VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X45 VDD OUT STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X46 VDD OUT STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
X47 STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# OUT VDD VDD sky130_fd_pr__pfet_01v8 ad=0p pd=0u as=0p ps=0u w=1.05e+06u l=150000u
C0 STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# OUT 1.29fF
C1 VDD m1_1258_1568# 7.25fF
C2 VDD OUT 7.03fF
C3 OUT m1_1258_1568# 1.34fF
C4 VDD STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# 6.86fF
C5 STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# m1_1258_1568# 1.02fF
C6 OUT GND 5.68fF
**FLOATING
C7 m1_1258_1568# GND 5.43fF
**FLOATING
C8 STAGE2_INV_3267744_0_0_1677844199_0/li_1007_571# GND 4.29fF
**FLOATING
C9 VDD GND 14.43fF
**FLOATING
.ends


*========Manually added========

x1 VDD out GND RINGOSCILLATOR_0
V1 VDD GND 1.8
.save i(v1)
**** begin user architecture code

.lib /home/swagatika/open_pdks/sky130/sky130A/libs.tech/ngspice/sky130.lib.spice tt

.save all
.tran 1p 5n
.control
run
plot out
.save all
.endc
.GLOBAL VDD
.GLOBAL GND
.end
```

**NgSpice Plot**

![Z11](https://user-images.githubusercontent.com/114692581/222719521-7fc77661-3a7a-46f1-8911-a7760dedbc63.PNG)

![Z12](https://user-images.githubusercontent.com/114692581/222719549-21fa9627-a257-49ad-a503-9824516d401d.PNG)


**Comparison between Pre-layout and Post-layout testbench of ring oscilator schematic :**
| Ring Oscillator | Pre-layout [Xschem] | Post-layout [ALIGN] |
| --------------- | ------------------- | ------------------- |
| Output | ![z4](https://user-images.githubusercontent.com/114692581/222720417-451c814c-81a3-4c1a-9c27-5fd26459a1c2.PNG) | ![Z12](https://user-images.githubusercontent.com/114692581/222720348-c77760ba-ae89-405f-837c-703586a5bf46.PNG) |

It has been noticed that the post-layout simulation [using ALIGN] result is same as the pre-layout simulation result of ring oscillator. Though because of capacitance parasitics in the post-layout simulation, time period is longer and less voltage magnitude as compare to pre-layout simulation. 





